function handleDropFileSelect(evt){var dropZone=document.getElementById("uploader");dropZone.innerHTML="Loading file";handleDragOver(evt);var files=evt.dataTransfer.files;var fileReader=new FileReader;var theFile=files[0];fileReader.onloadend=function(evtx){fileUpload(theFile.name,evtx.target.result)};fileReader.readAsArrayBuffer(theFile)}function fileUpload(name,fileData){var dropZone=document.getElementById("uploader");dropZone.innerHTML='<div class="container">Uploading<br /><div id="barUpload" style="margin-left: 50px; margin-right: 50px;" class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>';var xhr=new XMLHttpRequest;xhr.upload.addEventListener("loadstart",uploadStart,false);xhr.upload.addEventListener("progress",uploadProgress,false);xhr.upload.addEventListener("load",uploadComplete,false);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status==200){document.location.href="/"+xhr.responseText}else{setupDropZone();alert("Upload error: "+xhr.responseText)}}};xhr.open("PUT","/create?"+escape(name));xhr.send(fileData)}function uploadStart(evt){}function uploadComplete(evt){}function uploadProgress(evt){if(evt.lengthComputable){$("#barUpload").removeClass("active");$("#barUpload div.bar").css("width",evt.loaded/evt.total*100+"%")}}function handleDragOver(evt){evt.stopPropagation();evt.preventDefault();evt.dataTransfer.dropEffect=evt.type=="dragover"?"copy":"";evt.target.className=evt.type=="dragover"?"hover":""}function setupDropZone(){var dropZone=document.getElementById("uploader");dropZone.innerHTML="Drag & drop files here to upload them";dropZone.style.border="2px dashed #555";dropZone.style.borderRadius="7px";dropZone.style.fontWeight="bold";dropZone.style.textAlign="center";dropZone.style.color="#555";dropZone.style.padding="1em 0";dropZone.addEventListener("dragover",handleDragOver,false);dropZone.addEventListener("dragleave",handleDragOver,false);dropZone.addEventListener("drop",handleDropFileSelect,false)}setupDropZone()